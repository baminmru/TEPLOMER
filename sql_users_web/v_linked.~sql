CREATE OR REPLACE FORCE VIEW "COUNTERS"."V_L_HOUR" ("ID", "ID_BD", "ID_DU", "ID_PTYPE", "DCALL", "DCOUNTER", "Q1", "Q2", "T1", "T2", "DT12", "T3", "T4", "T5", "DT45", "T6", "V1", "V2", "DV12", "V3", "V4", "V5", "DV45", "V6", "M1", "M2", "DM12", "M3", "M4", "M5", "DM45", "M6", "P1", "P2", "P3", "P4", "P5", "P6", "G1", "G2", "G3", "G4", "G5", "G6", "TCOOL", "TCE1", "TCE2", "TSUM1", "TSUM2", "Q1H", "Q2H", "V1H", "V2H", "V4H", "V5H", "ERRTIME", "ERRTIMEH", "HC", "SP", "SP_TB1", "SP_TB2", "DATECOUNTER", "DG12", "DG45", "DP12", "DP45", "UNITSR", "Q3", "Q4", "PATM", "Q5", "DQ12", "DQ45", "PXB", "DQ", "HC_1", "HC_2", "THOT", "DANS1", "DANS2", "DANS3", "DANS4", "DANS5", "DANS6", "CHECK_A", "OKTIME", "WORKTIME", "TAIR1", "TAIR2", "HC_CODE", "ERRTIME2", "OKTIME2", "Q6", "D_EQL_24", "HCRAW1", "HCRAW2", "HCRAW", "L_TAIR1", "L_T1", "L_T2", "L_T3", "L_T4", "L_T5", "L_T6", "L_G1", "L_G2", "L_G3", "L_G4", "L_G5", "L_G6", "L_V1", "L_V2", "L_V3", "L_V4", "L_V5", "L_V6", "L_Q1", "L_Q2", "L_Q3", "L_Q4", "L_P1", "L_P2", "L_P3", "L_P4", "L_P5", "L_P6") AS 
  select datacurr."ID",datacurr."ID_BD",datacurr."ID_DU",datacurr."ID_PTYPE",datacurr."DCALL",datacurr."DCOUNTER",datacurr."Q1",datacurr."Q2",datacurr."T1",datacurr."T2",datacurr."DT12",datacurr."T3",datacurr."T4",datacurr."T5",datacurr."DT45",datacurr."T6",datacurr."V1",datacurr."V2",datacurr."DV12",datacurr."V3",datacurr."V4",datacurr."V5",datacurr."DV45",datacurr."V6",datacurr."M1",datacurr."M2",datacurr."DM12",datacurr."M3",datacurr."M4",datacurr."M5",datacurr."DM45",datacurr."M6",datacurr."P1",datacurr."P2",datacurr."P3",datacurr."P4",datacurr."P5",datacurr."P6",datacurr."G1",datacurr."G2",datacurr."G3",datacurr."G4",datacurr."G5",datacurr."G6",datacurr."TCOOL",datacurr."TCE1",datacurr."TCE2",datacurr."TSUM1",datacurr."TSUM2",datacurr."Q1H",datacurr."Q2H",datacurr."V1H",datacurr."V2H",datacurr."V4H",datacurr."V5H",datacurr."ERRTIME",datacurr."ERRTIMEH",datacurr."HC",datacurr."SP",datacurr."SP_TB1",datacurr."SP_TB2",datacurr."DATECOUNTER",datacurr."DG12",datacurr."DG45",datacurr."DP12",datacurr."DP45",datacurr."UNITSR",datacurr."Q3",datacurr."Q4",datacurr."PATM",datacurr."Q5",datacurr."DQ12",datacurr."DQ45",datacurr."PXB",datacurr."DQ",datacurr."HC_1",datacurr."HC_2",datacurr."THOT",datacurr."DANS1",datacurr."DANS2",datacurr."DANS3",datacurr."DANS4",datacurr."DANS5",datacurr."DANS6",datacurr."CHECK_A",datacurr."OKTIME",datacurr."WORKTIME",datacurr."TAIR1",datacurr."TAIR2",datacurr."HC_CODE",datacurr."ERRTIME2",datacurr."OKTIME2",datacurr."Q6",datacurr."D_EQL_24",datacurr."HCRAW1",datacurr."HCRAW2",datacurr."HCRAW"
,dans.tair1   as L_tair1  ,dans.t1   as L_t1  ,dans.t2   as L_t2  ,dans.t3   as L_t3  ,dans.t4   as L_t4  ,dans.t5   as L_t5  ,dans.t6   as L_t6             ,dans.G1   as L_G1  ,dans.G2   as L_G2  ,dans.G3   as L_G3  ,dans.G4   as L_G4  ,dans.G5   as L_G5  ,dans.G6   as L_G6                        ,dans.v1   as L_v1  ,dans.v2   as L_v2  ,dans.v3   as L_v3  ,dans.v4   as L_v4  ,dans.v5   as L_v5  ,dans.v6   as L_v6             ,dans.Q1   as L_Q1  ,dans.Q2   as L_Q2  ,dans.Q3   as L_Q3  ,dans.Q4   as L_Q4                        ,dans.p1   as L_p1  ,dans.p2   as L_p2  ,dans.p3   as L_p3  ,dans.p4   as L_p4  ,dans.p5   as L_p5  ,dans.p6   as L_p6
  from datacurr
join bdevices on datacurr.id_bd=bdevices.ID_BD
left join datacurr dans on dans.id_bd=bdevices.Linked_id_bd and dans.id_ptype=1 and dans.dcounter >=datacurr.dcounter and dans.dcounter <=(datacurr.dcounter +15/24/60)
;

CREATE OR REPLACE FORCE VIEW "COUNTERS"."V_LINKED_HOUR" ("ID", "ID_BD", "ID_DU", "ID_PTYPE", "DCALL", "DCOUNTER", "Q1", "Q2", "T1", "T2", "DT12", "T3", "T4", "T5", "DT45", "T6", "V1", "V2", "DV12", "V3", "V4", "V5", "DV45", "V6", "M1", "M2", "DM12", "M3", "M4", "M5", "DM45", "M6", "P1", "P2", "P3", "P4", "P5", "P6", "G1", "G2", "G3", "G4", "G5", "G6", "TCOOL", "TCE1", "TCE2", "TSUM1", "TSUM2", "Q1H", "Q2H", "V1H", "V2H", "V4H", "V5H", "ERRTIME", "ERRTIMEH", "HC", "SP", "SP_TB1", "SP_TB2", "DATECOUNTER", "DG12", "DG45", "DP12", "DP45", "UNITSR", "Q3", "Q4", "PATM", "Q5", "DQ12", "DQ45", "PXB", "DQ", "HC_1", "HC_2", "THOT", "DANS1", "DANS2", "DANS3", "DANS4", "DANS5", "DANS6", "CHECK_A", "OKTIME", "WORKTIME", "TAIR1", "TAIR2", "HC_CODE", "ERRTIME2", "OKTIME2", "Q6", "D_EQL_24", "HCRAW1", "HCRAW2", "HCRAW", "L_TAIR1", "L_T1", "L_T2", "L_T3", "L_T4", "L_T5", "L_T6", "L_G1", "L_G2", "L_G3", "L_G4", "L_G5", "L_G6", "L_V1", "L_V2", "L_V3", "L_V4", "L_V5", "L_V6", "L_Q1", "L_Q2", "L_Q3", "L_Q4", "L_P1", "L_P2", "L_P3", "L_P4", "L_P5", "L_P6") AS 
  select datacurr."ID",datacurr."ID_BD",datacurr."ID_DU",datacurr."ID_PTYPE",datacurr."DCALL",datacurr."DCOUNTER",datacurr."Q1",datacurr."Q2",datacurr."T1",datacurr."T2",datacurr."DT12",datacurr."T3",datacurr."T4",datacurr."T5",datacurr."DT45",datacurr."T6",datacurr."V1",datacurr."V2",datacurr."DV12",datacurr."V3",datacurr."V4",datacurr."V5",datacurr."DV45",datacurr."V6",datacurr."M1",datacurr."M2",datacurr."DM12",datacurr."M3",datacurr."M4",datacurr."M5",datacurr."DM45",datacurr."M6",datacurr."P1",datacurr."P2",datacurr."P3",datacurr."P4",datacurr."P5",datacurr."P6",datacurr."G1",datacurr."G2",datacurr."G3",datacurr."G4",datacurr."G5",datacurr."G6",datacurr."TCOOL",datacurr."TCE1",datacurr."TCE2",datacurr."TSUM1",datacurr."TSUM2",datacurr."Q1H",datacurr."Q2H",datacurr."V1H",datacurr."V2H",datacurr."V4H",datacurr."V5H",datacurr."ERRTIME",datacurr."ERRTIMEH",datacurr."HC",datacurr."SP",datacurr."SP_TB1",datacurr."SP_TB2",datacurr."DATECOUNTER",datacurr."DG12",datacurr."DG45",datacurr."DP12",datacurr."DP45",datacurr."UNITSR",datacurr."Q3",datacurr."Q4",datacurr."PATM",datacurr."Q5",datacurr."DQ12",datacurr."DQ45",datacurr."PXB",datacurr."DQ",datacurr."HC_1",datacurr."HC_2",datacurr."THOT",datacurr."DANS1",datacurr."DANS2",datacurr."DANS3",datacurr."DANS4",datacurr."DANS5",datacurr."DANS6",datacurr."CHECK_A",datacurr."OKTIME",datacurr."WORKTIME",datacurr."TAIR1",datacurr."TAIR2",datacurr."HC_CODE",datacurr."ERRTIME2",datacurr."OKTIME2",datacurr."Q6",datacurr."D_EQL_24",datacurr."HCRAW1",datacurr."HCRAW2",datacurr."HCRAW"
,dans.tair1   as L_tair1  ,dans.t1   as L_t1  ,dans.t2   as L_t2  ,dans.t3   as L_t3  ,dans.t4   as L_t4  ,dans.t5   as L_t5  ,dans.t6   as L_t6             ,dans.G1   as L_G1  ,dans.G2   as L_G2  ,dans.G3   as L_G3  ,dans.G4   as L_G4  ,dans.G5   as L_G5  ,dans.G6   as L_G6                        ,dans.v1   as L_v1  ,dans.v2   as L_v2  ,dans.v3   as L_v3  ,dans.v4   as L_v4  ,dans.v5   as L_v5  ,dans.v6   as L_v6             ,dans.Q1   as L_Q1  ,dans.Q2   as L_Q2  ,dans.Q3   as L_Q3  ,dans.Q4   as L_Q4                        ,dans.p1   as L_p1  ,dans.p2   as L_p2  ,dans.p3   as L_p3  ,dans.p4   as L_p4  ,dans.p5   as L_p5  ,dans.p6   as L_p6
  from datacurr
join bdevices on datacurr.id_bd=bdevices.ID_BD
left join datacurr dans on dans.id_bd=bdevices.Linked_id_bd and dans.id_ptype=1 and dans.dcounter >=datacurr.dcounter and dans.dcounter <=(datacurr.dcounter +15/24/60)
;

CREATE OR REPLACE FORCE VIEW "COUNTERS"."V_LINKED_MOMENT" ("ID", "ID_BD", "ID_DU", "ID_PTYPE", "DCALL", "DCOUNTER", "Q1", "Q2", "T1", "T2", "DT12", "T3", "T4", "T5", "DT45", "T6", "V1", "V2", "DV12", "V3", "V4", "V5", "DV45", "V6", "M1", "M2", "DM12", "M3", "M4", "M5", "DM45", "M6", "P1", "P2", "P3", "P4", "P5", "P6", "G1", "G2", "G3", "G4", "G5", "G6", "TCOOL", "TCE1", "TCE2", "TSUM1", "TSUM2", "Q1H", "Q2H", "V1H", "V2H", "V4H", "V5H", "ERRTIME", "ERRTIMEH", "HC", "SP", "SP_TB1", "SP_TB2", "DATECOUNTER", "DG12", "DG45", "DP12", "DP45", "UNITSR", "Q3", "Q4", "PATM", "Q5", "DQ12", "DQ45", "PXB", "DQ", "HC_1", "HC_2", "THOT", "DANS1", "DANS2", "DANS3", "DANS4", "DANS5", "DANS6", "CHECK_A", "OKTIME", "WORKTIME", "TAIR1", "TAIR2", "HC_CODE", "ERRTIME2", "OKTIME2", "Q6", "D_EQL_24", "HCRAW1", "HCRAW2", "HCRAW", "L_TAIR1", "L_T1", "L_T2", "L_T3", "L_T4", "L_T5", "L_T6", "L_G1", "L_G2", "L_G3", "L_G4", "L_G5", "L_G6", "L_V1", "L_V2", "L_V3", "L_V4", "L_V5", "L_V6", "L_Q1", "L_Q2", "L_Q3", "L_Q4", "L_P1", "L_P2", "L_P3", "L_P4", "L_P5", "L_P6") AS 
  select datacurr."ID",datacurr."ID_BD",datacurr."ID_DU",datacurr."ID_PTYPE",datacurr."DCALL",datacurr."DCOUNTER",datacurr."Q1",datacurr."Q2",datacurr."T1",datacurr."T2",datacurr."DT12",datacurr."T3",datacurr."T4",datacurr."T5",datacurr."DT45",datacurr."T6",datacurr."V1",datacurr."V2",datacurr."DV12",datacurr."V3",datacurr."V4",datacurr."V5",datacurr."DV45",datacurr."V6",datacurr."M1",datacurr."M2",datacurr."DM12",datacurr."M3",datacurr."M4",datacurr."M5",datacurr."DM45",datacurr."M6",datacurr."P1",datacurr."P2",datacurr."P3",datacurr."P4",datacurr."P5",datacurr."P6",datacurr."G1",datacurr."G2",datacurr."G3",datacurr."G4",datacurr."G5",datacurr."G6",datacurr."TCOOL",datacurr."TCE1",datacurr."TCE2",datacurr."TSUM1",datacurr."TSUM2",datacurr."Q1H",datacurr."Q2H",datacurr."V1H",datacurr."V2H",datacurr."V4H",datacurr."V5H",datacurr."ERRTIME",datacurr."ERRTIMEH",datacurr."HC",datacurr."SP",datacurr."SP_TB1",datacurr."SP_TB2",datacurr."DATECOUNTER",datacurr."DG12",datacurr."DG45",datacurr."DP12",datacurr."DP45",datacurr."UNITSR",datacurr."Q3",datacurr."Q4",datacurr."PATM",datacurr."Q5",datacurr."DQ12",datacurr."DQ45",datacurr."PXB",datacurr."DQ",datacurr."HC_1",datacurr."HC_2",datacurr."THOT",datacurr."DANS1",datacurr."DANS2",datacurr."DANS3",datacurr."DANS4",datacurr."DANS5",datacurr."DANS6",datacurr."CHECK_A",datacurr."OKTIME",datacurr."WORKTIME",datacurr."TAIR1",datacurr."TAIR2",datacurr."HC_CODE",datacurr."ERRTIME2",datacurr."OKTIME2",datacurr."Q6",datacurr."D_EQL_24",datacurr."HCRAW1",datacurr."HCRAW2",datacurr."HCRAW"
,dans.tair1   as L_tair1  ,dans.t1   as L_t1  ,dans.t2   as L_t2  ,dans.t3   as L_t3  ,dans.t4   as L_t4  ,dans.t5   as L_t5  ,dans.t6   as L_t6             ,dans.G1   as L_G1  ,dans.G2   as L_G2  ,dans.G3   as L_G3  ,dans.G4   as L_G4  ,dans.G5   as L_G5  ,dans.G6   as L_G6                        ,dans.v1   as L_v1  ,dans.v2   as L_v2  ,dans.v3   as L_v3  ,dans.v4   as L_v4  ,dans.v5   as L_v5  ,dans.v6   as L_v6             ,dans.Q1   as L_Q1  ,dans.Q2   as L_Q2  ,dans.Q3   as L_Q3  ,dans.Q4   as L_Q4                        ,dans.p1   as L_p1  ,dans.p2   as L_p2  ,dans.p3   as L_p3  ,dans.p4   as L_p4  ,dans.p5   as L_p5  ,dans.p6   as L_p6
  from datacurr
join bdevices on datacurr.id_bd=bdevices.ID_BD
left join datacurr dans on dans.id_bd=bdevices.Linked_id_bd and dans.id_ptype=1 and dans.dcounter >=datacurr.dcounter and dans.dcounter <=(datacurr.dcounter +15/24/60)
;
